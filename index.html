<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ê–≤—Ç–æ –≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ | AutoCredit</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --primary:#115C30; --primary2:#3c8a5a; --secondary:#95C11F;
      --text:#0f172a; --muted:#64748B; --soft:#f6f9f6;
      --shadow:0 12px 36px rgba(0,0,0,.10); --r:18px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Arial,sans-serif;color:var(--text);background:#fff}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}
    header{position:sticky;top:0;background:rgba(255,255,255,.9);backdrop-filter:blur(8px);box-shadow:0 2px 16px rgba(0,0,0,.06);z-index:10}
    .head{display:flex;justify-content:space-between;align-items:center;padding:14px 0}
    .logo{font-weight:800;font-size:1.3rem;background:linear-gradient(135deg,var(--primary),var(--primary2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    a.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;text-decoration:none;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--primary2));color:#fff}
    .back{color:var(--muted);text-decoration:none;display:inline-flex;align-items:center;gap:6px;margin:18px 0}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:24px;margin:16px 0 36px}
    .gallery{background:#fff;border-radius:var(--r);box-shadow:var(--shadow);padding:14px}
    .hero{height:380px;border-radius:14px;background:#e8efe9 center/cover no-repeat;margin-bottom:10px}
    .thumbs{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
    .thumb{height:64px;border-radius:10px;background:#eef3ee center/cover no-repeat;cursor:pointer;outline:2px solid transparent}
    .thumb.active{outline-color:#b8ddb8}
    .box{background:#fff;border-radius:var(--r);box-shadow:var(--shadow);padding:18px}
    .title{font-size:1.6rem;font-weight:800;margin-bottom:6px}
    .specs{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);margin-bottom:8px}
    .pill{display:inline-block;background:#eef6ea;color:#1f6a3c;border-radius:999px;padding:6px 10px;font-weight:700;font-size:.9rem}
    .calc label{display:block;font-weight:700;margin-bottom:6px}
    .range{appearance:none;width:100%;height:8px;border-radius:6px;background:#e5ebe7;outline:none;cursor:pointer}
    .range::-webkit-slider-thumb{appearance:none;width:22px;height:22px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--primary2));border:3px solid #fff;box-shadow:0 4px 12px rgba(0,0,0,.18)}
    .row{margin-bottom:16px}
    .pre{display:flex;gap:10px;align-items:center}
    .num{width:190px;padding:10px 12px;border:2px solid #e2e8f0;border-radius:10px;font-weight:700}
    .out{background:linear-gradient(135deg,#F0FDF4,#DCFCE7);border:2px solid #BBF7D0;border-radius:14px;padding:16px;margin-top:10px}
    .out p{display:flex;justify-content:space-between;margin:6px 0;font-weight:700}
    .actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:14px}
    .wa{background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;text-decoration:none;padding:12px;border-radius:12px;text-align:center;font-weight:800}
    .call{background:linear-gradient(135deg,var(--primary),var(--primary2));color:#fff;text-decoration:none;padding:12px;border-radius:12px;text-align:center;font-weight:800}
    .hint{background:linear-gradient(135deg,#FEF7ED,#FED7AA);border-left:4px solid #EA580C;color:#9A3412;border-radius:10px;padding:10px 12px;font-weight:700;margin-top:10px}
    @media (max-width:1000px){.grid{grid-template-columns:1fr;}}
  </style>
</head>
<body>
<header>
  <div class="container head">
    <div class="logo">AutoCredit</div>
    <a class="btn" href="tel:+79280222114">üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å</a>
  </div>
</header>

<main class="container">
  <a class="back" href="index.html">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</a>

  <div class="grid">
    <!-- –ì–∞–ª–µ—Ä–µ—è -->
    <section class="gallery">
      <div id="hero" class="hero"></div>
      <div id="thumbs" class="thumbs"></div>
    </section>

    <!-- –ò–Ω—Ñ–æ + –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä -->
    <section class="box">
      <h1 id="title" class="title">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</h1>
      <div class="specs" id="specs"></div>
      <span id="pill" class="pill">–í –Ω–∞–ª–∏—á–∏–∏</span>

      <div class="calc" style="margin-top:14px">
        <div class="row">
          <label id="monthsLabel" for="months">–°—Ä–æ–∫: 3 –º–µ—Å—è—Ü–∞</label>
          <input id="months" class="range" type="range" min="3" max="12" step="1" value="3" />
        </div>

        <div class="row" id="preBlock">
          <label for="preSlider">–ü–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å</label>
          <div class="pre">
            <input id="preInput" class="num" type="number" step="100" placeholder="0" />
            <input id="preSlider" class="range" type="range" min="0" max="0" step="100" value="0" />
          </div>
          <div id="preErr" class="hint" style="display:none"></div>
        </div>

        <div id="out" class="out" aria-live="polite">
          <p><span>–ü–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å</span><span id="oPre">0 ‚ÇΩ</span></p>
          <p><span>–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂</span><span id="oMon">0 ‚ÇΩ</span></p>
          <p><span>–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span><span id="oFin">0 ‚ÇΩ</span></p>
        </div>

        <div class="hint">üí° –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: –ø–æ—Ä—É—á–∏—Ç–µ–ª—å –∏ –ø–∞—Å–ø–æ—Ä—Ç–∞ –æ–±–µ–∏—Ö –ª–∏—Ü</div>

        <div class="actions">
          <a id="wa" class="wa" href="#" target="_blank" rel="noopener">‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –≤ WhatsApp</a>
          <a class="call" href="tel:+79280222114">–ü–æ–∑–≤–æ–Ω–∏—Ç—å</a>
        </div>
      </div>
    </section>
  </div>
</main>

<script>
/* ------------------------- –î–ê–ù–ù–´–ï –ê–í–¢–û ------------------------- */
/* basePrice –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞. */
const CARS = {
  'solaris-2023': {
    name:'Hyundai Solaris', year:2023, engine:'1.6 –ª', trans:'–ê–ö–ü–ü', body:'–°–µ–¥–∞–Ω',
    basePrice: 850000, // TODO: –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π
    photos: [
      '/img/solaris-1.jpg', '/img/solaris-2.jpg', '/img/solaris-3.jpg', '/img/solaris-4.jpg', '/img/solaris-5.jpg'
    ]
  },
  'sportage-2023': {
    name:'Kia Sportage', year:2023, engine:'2.0 –ª', trans:'–ê–ö–ü–ü', body:'–ö—Ä–æ—Å—Å–æ–≤–µ—Ä',
    basePrice: 1650000,
    photos: ['/img/sportage-1.jpg','/img/sportage-2.jpg','/img/sportage-3.jpg','/img/sportage-4.jpg','/img/sportage-5.jpg']
  },
  'polo-2023': {
    name:'Volkswagen Polo', year:2023, engine:'1.6 –ª', trans:'–ú–ö–ü–ü', body:'–•—ç—Ç—á–±–µ–∫',
    basePrice: 950000,
    photos: ['/img/polo-1.jpg','/img/polo-2.jpg','/img/polo-3.jpg','/img/polo-4.jpg','/img/polo-5.jpg']
  },
  'camry-2023': {
    name:'Toyota Camry', year:2023, engine:'2.5 –ª', trans:'–ê–ö–ü–ü', body:'–°–µ–¥–∞–Ω',
    basePrice: 2100000,
    photos: ['/img/camry-1.jpg','/img/camry-2.jpg','/img/camry-3.jpg','/img/camry-4.jpg','/img/camry-5.jpg']
  },
  'cx5-2023': {
    name:'Mazda CX-5', year:2023, engine:'2.0 –ª', trans:'–ê–ö–ü–ü', body:'–ö—Ä–æ—Å—Å–æ–≤–µ—Ä',
    basePrice: 1800000,
    photos: ['/img/cx5-1.jpg','/img/cx5-2.jpg','/img/cx5-3.jpg','/img/cx5-4.jpg','/img/cx5-5.jpg']
  },
  'rapid-2023': {
    name:'Skoda Rapid', year:2023, engine:'1.6 –ª', trans:'–ê–ö–ü–ü', body:'–•—ç—Ç—á–±–µ–∫',
    basePrice: 780000,
    photos: ['/img/rapid-1.jpg','/img/rapid-2.jpg','/img/rapid-3.jpg','/img/rapid-4.jpg','/img/rapid-5.jpg']
  }
};

/* ------------------------- –£–¢–ò–õ–ò–¢–´ ------------------------- */
const qs = k => new URLSearchParams(location.search).get(k);
const f = n => (isNaN(n)?0:n).toLocaleString('ru-RU')+' ‚ÇΩ';
const ceil100 = v => Math.ceil(v/100)*100;
const monthWord = n => (n%10===1&&n%100!==11)?'–º–µ—Å—è—Ü':([2,3,4].includes(n%10)&&![12,13,14].includes(n%100)?'–º–µ—Å—è—Ü–∞':'–º–µ—Å—è—Ü–µ–≤');

/* –¢–∞–±–ª–∏—Ü—ã –Ω–∞—Ü–µ–Ω–æ–∫ (–∫–∞–∫ –º—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ä–∞–Ω–µ–µ) */
const markupWithDown      = {3:9,4:12,5:15,6:18,7:20,8:22,9:24,10:26,11:28,12:30};
const markupWithoutDown   = {3:13,4:17,5:21,6:25.5,7:28.5,8:32,9:35,10:38,11:41.5,12:45};
const markupNoDownPayment = {3:14,4:18,5:23,6:28,7:31,8:34,9:37,10:40,11:43,12:46};

/* ------------------------- DOM ------------------------- */
const hero   = document.getElementById('hero');
const thumbs = document.getElementById('thumbs');
const title  = document.getElementById('title');
const specs  = document.getElementById('specs');
const months = document.getElementById('months');
const monthsLabel = document.getElementById('monthsLabel');
const preBlock = document.getElementById('preBlock');
const preSlider= document.getElementById('preSlider');
const preInput = document.getElementById('preInput');
const preErr   = document.getElementById('preErr');
const oPre = document.getElementById('oPre');
const oMon = document.getElementById('oMon');
const oFin = document.getElementById('oFin');
const wa   = document.getElementById('wa');

/* ------------------------- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ------------------------- */
const slug = qs('car');
const car = CARS[slug];

if(!car){
  title.textContent = '–ê–≤—Ç–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ';
} else {
  // –†–µ–Ω–¥–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞
  title.textContent = car.name;
  specs.innerHTML = `<span>${car.engine}</span><span>${car.trans}</span><span>${car.year} –≥.</span><span>${car.body}</span>`;

  const photos = (car.photos && car.photos.length ? car.photos : ['/img/placeholder.jpg']);
  hero.style.backgroundImage = `url('${photos[0]}')`;
  thumbs.innerHTML = photos.slice(0,5).map((src,i)=>`
    <div class="thumb ${i===0?'active':''}" data-src="${src}" style="background-image:url('${src}')"></div>
  `).join('');
  thumbs.querySelectorAll('.thumb').forEach(t=>{
    t.addEventListener('click',()=>{
      thumbs.querySelectorAll('.thumb').forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      hero.style.backgroundImage = `url('${t.dataset.src}')`;
    });
  });

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
  months.addEventListener('input', ()=>update(true));
  preSlider.addEventListener('input', ()=>update(false));
  preInput.addEventListener('input', ()=>{
    const val = ceil100(parseInt(preInput.value||'0',10));
    const min = parseInt(preSlider.min,10), max = parseInt(preSlider.max,10);
    if(val>=min && val<=max){
      preErr.style.display='none';
      preSlider.value = val;
      update(false);
    } else {
      preErr.textContent = `–ü–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç ${min.toLocaleString('ru-RU')} ‚ÇΩ –¥–æ ${max.toLocaleString('ru-RU')} ‚ÇΩ`;
      preErr.style.display='block';
    }
  });

  update(true);
}

/* ------------------------- –õ–û–ì–ò–ö–ê –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê ------------------------- */
let conditional = 0;
function update(resetPre){
  const m = parseInt(months.value,10);
  monthsLabel.textContent = `–°—Ä–æ–∫: ${m} ${monthWord(m)}`;

  const price = car.basePrice; // —Å–∫—Ä—ã—Ç–∞—è –±–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
  // –î–ª—è –º–∞—à–∏–Ω—ã –±–µ–∑ "–≤—ã–±–æ—Ä–∞ —Ç–∞—Ä–∏—Ñ–∞" —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ —Ç–∞—Ä–∏—Ñ "–° –ø–µ—Ä–≤—ã–º –≤–∑–Ω–æ—Å–æ–º" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é,
  // –Ω–æ –µ—Å–ª–∏ –ø–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —É—Å–ª–æ–≤–Ω–æ–≥–æ ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ–º –ª–æ–≥–∏–∫—É –∫–∞–∫ "–±–µ–∑ –≤–∑–Ω–æ—Å–∞" –∫ –æ—Å—Ç–∞—Ç–∫—É.
  const basePercent = markupWithDown[m];
  const baseFinal   = price*(1+basePercent/100);

  const minPre = ceil100(baseFinal*0.15);
  const maxPre = ceil100(baseFinal*0.65);
  conditional  = ceil100(baseFinal*0.25); // —É—Å–ª–æ–≤–Ω—ã–π –ø–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å (25%)

  preSlider.min = minPre;
  preSlider.max = maxPre;

  if(resetPre){
    preSlider.value = conditional;
  }

  // –ú–∞–≥–Ω–∏—Ç –∫ 25% (+/- 2000 ‚ÇΩ)
  const snap = 2000;
  let pre = parseInt(preSlider.value,10) || minPre;
  if(Math.abs(pre - conditional) <= snap){
    pre = conditional; preSlider.value = conditional;
  }
  preInput.value = pre;

  let monthly, finalCost;
  if(pre === conditional){
    const rest = baseFinal - pre;
    monthly = ceil100(rest / m);
    finalCost = monthly*m + pre;
  } else {
    const rest = price - pre;
    const restWithMarkup = rest*(1 + markupWithoutDown[m]/100);
    monthly = ceil100(restWithMarkup / m);
    finalCost = monthly*m + pre;
  }

  oPre.textContent = f(pre);
  oMon.textContent = f(monthly);
  oFin.textContent = f(finalCost);

  const msg = `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –æ—Ñ–æ—Ä–º–∏—Ç—å —Ä–∞—Å—Å—Ä–æ—á–∫—É –Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å: ${car.name}. –°—Ä–æ–∫: ${m} –º–µ—Å. –ü–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å: ${pre.toLocaleString('ru-RU')} ‚ÇΩ. –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂: ${monthly.toLocaleString('ru-RU')} ‚ÇΩ.`;
  wa.href = `https://wa.me/79280222114?text=${encodeURIComponent(msg)}`;
}
</script>
</body>
</html>
