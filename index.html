<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .login-form {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-form h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .login-btn:hover {
            transform: translateY(-2px);
        }

        .main-container {
            background: #f5f5f5;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 1.8em;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .navigation {
            background: white;
            padding: 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .nav-tabs {
            display: flex;
            list-style: none;
        }

        .nav-tabs li {
            flex: 1;
        }

        .nav-tabs button {
            width: 100%;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .nav-tabs button.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: #f8f9ff;
        }

        .nav-tabs button:hover {
            background: #f0f0f0;
        }

        .content {
            padding: 20px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
            font-size: 0.9em;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group-inline {
            display: flex;
            flex-direction: column;
        }

        .form-group-inline label {
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
            font-size: 14px;
        }

        .form-group-inline input, .form-group-inline select {
            padding: 10px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group-inline input:focus, .form-group-inline select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: transform 0.2s;
            margin-right: 10px;
        }

        .btn:hover {
            transform: translateY(-1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e1e1;
        }

        th {
            background: #f8f9ff;
            font-weight: 600;
            color: #333;
        }

        tr:hover {
            background: #f8f9ff;
        }

        .status-paid {
            background: #d4edda;
            color: #155724;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-overdue {
            background: #f8d7da;
            color: #721c24;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .search-bar {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
            transition: border-color 0.3s;
        }

        .search-bar:focus {
            outline: none;
            border-color: #667eea;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div class="main-container" id="mainContainer">
        <div class="header">
            <h1>–°–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∏</h1>
            <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
        </div>

        <nav class="navigation">
            <ul class="nav-tabs">
                <li><button onclick="showTab('accounting')" class="tab-btn active">–£—á–µ—Ç</button></li>
                <li><button onclick="showTab('finance')" class="tab-btn">–§–∏–Ω–∞–Ω—Å—ã</button></li>
                <li><button onclick="showTab('cashbox')" class="tab-btn">–ö–∞—Å—Å–∞</button></li>
                <li><button onclick="showTab('payments')" class="tab-btn">–ü–ª–∞—Ç–µ–∂–∏</button></li>
                <li><button onclick="showTab('analytics')" class="tab-btn">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button></li>
            </ul>
        </nav>

        <div class="content">
            <!-- –í–∫–ª–∞–¥–∫–∞ –£—á–µ—Ç -->
            <div class="tab-content active" id="accounting">
                <div class="card">
                    <h2>–£—á–µ—Ç —Ä–∞—Å—Å—Ä–æ—á–∫–∏</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="totalContracts">0</h3>
                            <p>–í—Å–µ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–æ–≤</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="activeContracts">0</h3>
                            <p>–ê–∫—Ç–∏–≤–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="totalDebt">0 ‚ÇΩ</h3>
                            <p>–û–±—â–∏–π –¥–æ–ª–≥</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="monthlyPayments">0 ‚ÇΩ</h3>
                            <p>–ü–ª–∞—Ç–µ–∂–∏ –∑–∞ –º–µ—Å—è—Ü</p>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="showAddContractModal()">+ –î–æ–±–∞–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä</button>
                    
                    <input type="text" class="search-bar" placeholder="–ü–æ–∏—Å–∫ –ø–æ –§–ò–û, –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ —Ç–æ–≤–∞—Ä—É..." onkeyup="searchContracts(this.value)">
                    
                    <div class="table-container">
                        <table id="contractsTable">
                            <thead>
                                <tr>
                                    <th>‚Ññ</th>
                                    <th>–î–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏</th>
                                    <th>–§–ò–û</th>
                                    <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                    <th>–ü–æ—Ä—É—á–∏—Ç–µ–ª—å</th>
                                    <th>–¢–æ–≤–∞—Ä</th>
                                    <th>–ü–∞—Ä—Ç–Ω–µ—Ä</th>
                                    <th>–¶–µ–Ω–∞</th>
                                    <th>–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞</th>
                                    <th>–ú–µ—Å—è—Ü–µ–≤</th>
                                    <th>–ï–∂–µ–º–µ—Å—è—á–Ω–æ</th>
                                    <th>–û—Å—Ç–∞—Ç–æ–∫</th>
                                    <th>1-–π –≤–∑–Ω–æ—Å</th>
                                    <th>2-–π –≤–∑–Ω–æ—Å</th>
                                    <th>3-–π –≤–∑–Ω–æ—Å</th>
                                    <th>4-–π –≤–∑–Ω–æ—Å</th>
                                    <th>5-–π –≤–∑–Ω–æ—Å</th>
                                    <th>–ü—Ä–æ—Å—Ä–æ—á–∫–∞</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="contractsTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –§–∏–Ω–∞–Ω—Å—ã -->
            <div class="tab-content" id="finance">
                <div class="card">
                    <h2>–£—á–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="dailyRevenue">0 ‚ÇΩ</h3>
                            <p>–í—ã—Ä—É—á–∫–∞ –∑–∞ –¥–µ–Ω—å</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="monthlyRevenue">0 ‚ÇΩ</h3>
                            <p>–í—ã—Ä—É—á–∫–∞ –∑–∞ –º–µ—Å—è—Ü</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="totalExpenses">0 ‚ÇΩ</h3>
                            <p>–†–∞—Å—Ö–æ–¥—ã</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="netProfit">0 ‚ÇΩ</h3>
                            <p>–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</p>
                        </div>
                    </div>

                    <button class="btn btn-success" onclick="showFinanceModal('income')">+ –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥</button>
                    <button class="btn btn-danger" onclick="showFinanceModal('expense')">+ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</button>
                    
                    <div class="table-container">
                        <table id="financeTable">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                    <th>–°—É–º–º–∞</th>
                                    <th>–ò—Å—Ç–æ—á–Ω–∏–∫</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="financeTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ö–∞—Å—Å–∞ -->
            <div class="tab-content" id="cashbox">
                <div class="card">
                    <h2>–ö–∞—Å—Å–∞</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="cashAmount">0 ‚ÇΩ</h3>
                            <p>–ù–∞–ª–∏—á–Ω—ã–µ –≤ –∫–∞—Å—Å–µ</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="cardAmount">0 ‚ÇΩ</h3>
                            <p>–ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="totalAdvance">0 ‚ÇΩ</h3>
                            <p>–ü—Ä–µ–¥–æ–ø–ª–∞—Ç—ã</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="totalInstallments">0 ‚ÇΩ</h3>
                            <p>–í–∑–Ω–æ—Å—ã</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ü–ª–∞—Ç–µ–∂–∏ -->
            <div class="tab-content" id="payments">
                <div class="card">
                    <h2>–ü–ª–∞—Ç–µ–∂–∏</h2>
                    
                    <button class="btn btn-primary" onclick="showPaymentModal()">+ –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂</button>
                    
                    <input type="text" class="search-bar" placeholder="–ü–æ–∏—Å–∫ –ø–ª–∞—Ç–µ–∂–µ–π..." onkeyup="searchPayments(this.value)">
                    
                    <div class="table-container">
                        <table id="paymentsTable">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞</th>
                                    <th>–†–∞–∑–º–µ—Ä –ø–ª–∞—Ç–µ–∂–∞</th>
                                    <th>–¢–∏–ø –ø–ª–∞—Ç–µ–∂–∞</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
            <div class="tab-content" id="analytics">
                <div class="card">
                    <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="conversionRate">0%</h3>
                            <p>–ö–æ–Ω–≤–µ—Ä—Å–∏—è</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="avgContractValue">0 ‚ÇΩ</h3>
                            <p>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="overdueContracts">0</h3>
                            <p>–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="completedContracts">0</h3>
                            <p>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</p>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group-inline">
                            <label>–ü–µ—Ä–∏–æ–¥ –æ—Ç—á–µ—Ç–∞:</label>
                            <select onchange="updateAnalytics(this.value)">
                                <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
                                <option value="month" selected>–ó–∞ –º–µ—Å—è—Ü</option>
                                <option value="quarter">–ó–∞ –∫–≤–∞—Ä—Ç–∞–ª</option>
                                <option value="year">–ó–∞ –≥–æ–¥</option>
                            </select>
                        </div>
                        <div class="form-group-inline">
                            <label>&nbsp;</label>
                            <button class="btn btn-primary" onclick="exportReport()">–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ -->
    <div class="modal" id="contractModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('contractModal')">&times;</span>
            <h2>–ù–æ–≤—ã–π –¥–æ–≥–æ–≤–æ—Ä —Ä–∞—Å—Å—Ä–æ—á–∫–∏</h2>
            <form id="contractForm">
                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞:</label>
                        <input type="text" name="clientName" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–∫—É–ø–∞—Ç–µ–ª—è:</label>
                        <input type="tel" name="clientPhone" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ—Ä—É—á–∏—Ç–µ–ª—è:</label>
                        <input type="tel" name="guarantorPhone">
                    </div>
                    <div class="form-group-inline">
                        <label>–ê–¥—Ä–µ—Å:</label>
                        <input type="text" name="address">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:</label>
                        <input type="text" name="productName" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–ü–∞—Ä—Ç–Ω–µ—Ä:</label>
                        <select name="partner">
                            <option value="–•–∞–π—Ä –°—Ç—Ä–æ–π">–•–∞–π—Ä –°—Ç—Ä–æ–π</option>
                            <option value="–ò—Å–∞ –∫–∏—Ä–ø–∏—á">–ò—Å–∞ –∫–∏—Ä–ø–∏—á</option>
                            <option value="–ü—Ä–æ—á–∏–π">–ü—Ä–æ—á–∏–π</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å:</label>
                        <input type="number" name="costPrice" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏:</label>
                        <input type="number" name="salePrice" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞:</label>
                        <input type="number" name="downPayment" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—è—Ü–µ–≤:</label>
                        <input type="number" name="months" min="1" max="12" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>IMEI —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</label>
                        <input type="text" name="imei">
                    </div>
                    <div class="form-group-inline">
                        <label>–°–∫–∏–¥–∫–∞:</label>
                        <input type="number" name="discount" value="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>&nbsp;</label>
                        <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π -->
    <div class="modal" id="financeModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('financeModal')">&times;</span>
            <h2 id="financeModalTitle">–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è</h2>
            <form id="financeForm">
                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–î–∞—Ç–∞:</label>
                        <input type="date" name="date" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:</label>
                        <select name="operationType" id="operationType">
                            <option value="income">–î–æ—Ö–æ–¥</option>
                            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                        <input type="text" name="description" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–°—É–º–º–∞:</label>
                        <input type="number" name="amount" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–ò—Å—Ç–æ—á–Ω–∏–∫/–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:</label>
                        <select name="source">
                            <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option>
                            <option value="card">–ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ</option>
                            <option value="transfer">–ü–µ—Ä–µ–≤–æ–¥</option>
                            <option value="other">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    <div class="form-group-inline">
                        <label>&nbsp;</label>
                        <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–ª–∞—Ç–µ–∂–µ–π -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('paymentModal')">&times;</span>
            <h2>–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂</h2>
            <form id="paymentForm">
                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞:</label>
                        <input type="date" name="paymentDate" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞:</label>
                        <select name="clientId" id="clientSelect" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–†–∞–∑–º–µ—Ä –ø–ª–∞—Ç–µ–∂–∞:</label>
                        <input type="number" name="paymentAmount" required>
                    </div>
                    <div class="form-group-inline">
                        <label>–¢–∏–ø –ø–ª–∞—Ç–µ–∂–∞:</label>
                        <select name="paymentType">
                            <option value="installment">–í–∑–Ω–æ—Å –ø–æ —Ä–∞—Å—Å—Ä–æ—á–∫–µ</option>
                            <option value="advance">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞</option>
                            <option value="full">–ü–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞</option>
                            <option value="partial">–ß–∞—Å—Ç–∏—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</label>
                        <select name="paymentMethod">
                            <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option>
                            <option value="card">–ö–∞—Ä—Ç–∞</option>
                            <option value="transfer">–ü–µ—Ä–µ–≤–æ–¥</option>
                        </select>
                    </div>
                    <div class="form-group-inline">
                        <label>&nbsp;</label>
                        <button type="submit" class="btn btn-primary">–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initializeApp() {
            updateDashboard();
            loadContracts();
            loadFinance();
            loadPayments();
            updateCashbox();
            updateAnalytics();
        }
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –±—É–¥–µ—Ç –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
        let appData = {
            contracts: [
                {
                    id: 2,
                    clientName: "–ú—É—Ü—É–µ–≤ –ò—Å–∞ –®–∞–π–∞–º–∞—Ö–º—É–¥–æ–≤–∏—á",
                    clientPhone: "8962 141 77 77",
                    guarantorPhone: "8928 262 68 68",
                    address: "–ì.–ì—Ä–æ–∑–Ω—ã–π, –£–ª –°—Ç–∞—Ä—ã–π –ø–æ—Å–µ–ª–æ–∫, 6",
                    productName: "–ê–π—Ñ–æ–Ω 16 –ø—Ä–æ 256 –≥–±",
                    partner: "–•–∞–π—Ä –°—Ç—Ä–æ–π",
                    costPrice: 100000,
                    salePrice: 111500,
                    downPayment: 50000,
                    months: 5,
                    monthlyPayment: 12300,
                    remainingDebt: 49200,
                    status: "active",
                    createdDate: "2025-03-02",
                    imei: "",
                    discount: 0
                }
            ],
            finance: [
                {
                    id: 1,
                    date: "2025-08-08",
                    type: "income",
                    description: "–ü–ª–∞—Ç–µ–∂ –ø–æ —Ä–∞—Å—Å—Ä–æ—á–∫–µ - –Æ—Å—É–ø–æ–≤ –ò–±—Ä–∞–≥–∏–º",
                    amount: 27500,
                    source: "cash"
                },
                {
                    id: 2,
                    date: "2025-08-07",
                    type: "expense",
                    description: "–ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏—è",
                    amount: 50000,
                    source: "cash"
                }
            ],
            payments: [
                {
                    id: 1,
                    date: "2025-08-08",
                    clientName: "–Æ—Å—É–ø–æ–≤ –ò–±—Ä–∞–≥–∏–º",
                    amount: 27500,
                    type: "installment",
                    method: "cash",
                    status: "completed"
                }
            ],
            cashbox: {
                cash: 881500,
                card: 0,
                totalAdvance: 7060300,
                totalInstallments: 5584400
            }
        };

        // –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞
        const credentials = {
            admin: "admin123",
            manager: "manager456",
            bek: "bek2025"
        };

        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É
        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            console.log('–ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞:', username, password); // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            if ((username === 'admin' && password === 'admin123') ||
                (username === 'manager' && password === 'manager456') ||
                (username === 'bek' && password === 'bek2025')) {
                
                console.log('–í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω!'); // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
                
                // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'block';
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
                updateDashboard();
                loadContracts();
                loadFinance();
                loadPayments();
                updateCashbox();
                updateAnalytics();
                
                alert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É!');
            } else {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å!\n\n‚úÖ –î–æ—Å—Ç—É–ø–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n\nüë§ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:\n   –õ–æ–≥–∏–Ω: admin\n   –ü–∞—Ä–æ–ª—å: admin123\n\nüë§ –ú–µ–Ω–µ–¥–∂–µ—Ä:\n   –õ–æ–≥–∏–Ω: manager\n   –ü–∞—Ä–æ–ª—å: manager456\n\nüë§ –ë–µ–∫:\n   –õ–æ–≥–∏–Ω: bek\n   –ü–∞—Ä–æ–ª—å: bek2025');
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
            }
        }

        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫ —Ñ–æ—Ä–º–µ
        document.addEventListener('DOMContentLoaded', function() {
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                if (document.getElementById('loginContainer').style.display !== 'none') {
                    console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏');
                }
            }, 2000);
        });

        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞ (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞)
        function logout() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
                location.reload();
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏
        function updateDashboard() {
            const totalContracts = appData.contracts.length;
            const activeContracts = appData.contracts.filter(c => c.status === 'active').length;
            const totalDebt = appData.contracts.reduce((sum, c) => sum + c.remainingDebt, 0);
            const monthlyPayments = appData.payments
                .filter(p => new Date(p.date).getMonth() === new Date().getMonth())
                .reduce((sum, p) => sum + p.amount, 0);

            document.getElementById('totalContracts').textContent = totalContracts;
            document.getElementById('activeContracts').textContent = activeContracts;
            document.getElementById('totalDebt').textContent = totalDebt.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('monthlyPayments').textContent = monthlyPayments.toLocaleString() + ' ‚ÇΩ';
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤
        function loadContracts() {
            const tbody = document.getElementById('contractsTableBody');
            tbody.innerHTML = '';
            
            appData.contracts.forEach((contract, index) => {
                const row = document.createElement('tr');
                
                let statusClass = '';
                let statusText = '';
                
                switch(contract.status) {
                    case 'paid':
                        statusClass = 'status-paid';
                        statusText = '–û–ø–ª–∞—á–µ–Ω';
                        break;
                    case 'active':
                        statusClass = 'status-pending';
                        statusText = '–ê–∫—Ç–∏–≤–µ–Ω';
                        break;
                    case 'overdue':
                        statusClass = 'status-overdue';
                        statusText = `–ü—Ä–æ—Å—Ä–æ—á–µ–Ω ${contract.overdueDays} –¥–Ω.`;
                        break;
                }

                // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π
                const payment1 = getPaymentStatus(contract.installments[0]);
                const payment2 = getPaymentStatus(contract.installments[1]);
                const payment3 = getPaymentStatus(contract.installments[2]);
                const payment4 = getPaymentStatus(contract.installments[3]);
                const payment5 = getPaymentStatus(contract.installments[4]);

                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Å—Ä–æ—á–∫—É
                const overdueInfo = calculateOverdue(contract);
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${new Date(contract.createdDate).toLocaleDateString()}</td>
                    <td style="font-weight: 500;">${contract.clientName}</td>
                    <td>${contract.clientPhone}</td>
                    <td>${contract.guarantorPhone || '-'}</td>
                    <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${contract.productName}">${contract.productName}</td>
                    <td>${contract.partner}</td>
                    <td style="font-weight: 600;">${contract.salePrice.toLocaleString()} ‚ÇΩ</td>
                    <td>${contract.downPayment.toLocaleString()} ‚ÇΩ</td>
                    <td>${contract.months}</td>
                    <td style="font-weight: 600; color: #667eea;">${contract.monthlyPayment.toLocaleString()} ‚ÇΩ</td>
                    <td style="font-weight: 600; color: ${contract.remainingDebt > 0 ? '#dc3545' : '#28a745'};">${contract.remainingDebt.toLocaleString()} ‚ÇΩ</td>
                    <td>${payment1}</td>
                    <td>${payment2}</td>
                    <td>${payment3}</td>
                    <td>${payment4}</td>
                    <td>${payment5}</td>
                    <td style="color: ${overdueInfo.days > 0 ? '#dc3545' : '#28a745'}; font-weight: 600;">${overdueInfo.text}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="btn btn-warning" onclick="showContractDetails(${contract.id})" style="padding: 6px 12px; font-size: 12px;">–î–µ—Ç–∞–ª–∏</button>
                        <button class="btn btn-success" onclick="addPaymentForContract(${contract.id})" style="padding: 6px 12px; font-size: 12px;">–ü–ª–∞—Ç–µ–∂</button>
                    </td>
                `;
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å—Ç—Ä–æ–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞
                if (contract.status === 'overdue') {
                    row.style.backgroundColor = '#fdf2f2';
                } else if (contract.status === 'paid') {
                    row.style.backgroundColor = '#f0f9f0';
                }
                
                tbody.appendChild(row);
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
        function getPaymentStatus(installment) {
            if (!installment) return '<span style="color: #ccc;">-</span>';
            
            const currentDate = new Date();
            const installmentDate = new Date(installment.date);
            
            if (installment.paid) {
                const paidDate = new Date(installment.paidDate);
                const isLate = paidDate > installmentDate;
                return `<span style="color: #28a745; font-weight: 600;">‚úì ${paidDate.toLocaleDateString()}${isLate ? ' (–ø–æ–∑–¥–Ω–æ)' : ''}</span>`;
            } else {
                const isOverdue = currentDate > installmentDate;
                const daysDiff = Math.floor((currentDate - installmentDate) / (1000 * 60 * 60 * 24));
                
                if (isOverdue) {
                    return `<span style="color: #dc3545; font-weight: 600;">‚úó –ü—Ä–æ—Å—Ä–æ—á–µ–Ω ${daysDiff} –¥–Ω.</span>`;
                } else {
                    return `<span style="color: #ffc107; font-weight: 600;">‚è≥ ${installmentDate.toLocaleDateString()}</span>`;
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –æ–±—â–µ–π –ø—Ä–æ—Å—Ä–æ—á–∫–∏
        function calculateOverdue(contract) {
            const currentDate = new Date();
            let maxOverdueDays = 0;
            
            contract.installments.forEach(installment => {
                if (!installment.paid) {
                    const installmentDate = new Date(installment.date);
                    if (currentDate > installmentDate) {
                        const daysDiff = Math.floor((currentDate - installmentDate) / (1000 * 60 * 60 * 24));
                        maxOverdueDays = Math.max(maxOverdueDays, daysDiff);
                    }
                }
            });
            
            return {
                days: maxOverdueDays,
                text: maxOverdueDays > 0 ? `${maxOverdueDays} –¥–Ω.` : '–í —Å—Ä–æ–∫'
            };
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –¥–µ—Ç–∞–ª–µ–π –¥–æ–≥–æ–≤–æ—Ä–∞
        function showContractDetails(contractId) {
            const contract = appData.contracts.find(c => c.id === contractId);
            if (!contract) return;
            
            let installmentsList = '';
            contract.installments.forEach((inst, index) => {
                const status = inst.paid ? 
                    `‚úì –û–ø–ª–∞—á–µ–Ω ${new Date(inst.paidDate).toLocaleDateString()}` : 
                    `‚ùå –ù–µ –æ–ø–ª–∞—á–µ–Ω (–¥–æ ${new Date(inst.date).toLocaleDateString()})`;
                    
                installmentsList += `
                    <div style="padding: 8px; margin: 4px 0; background: ${inst.paid ? '#f0f9f0' : '#fdf2f2'}; border-radius: 4px;">
                        <strong>${index + 1}-–π –≤–∑–Ω–æ—Å:</strong> ${inst.amount.toLocaleString()} ‚ÇΩ - ${status}
                    </div>
                `;
            });
            
            const overdueInfo = calculateOverdue(contract);
            
            alert(`–î–ï–¢–ê–õ–ò –î–û–ì–û–í–û–†–ê #${contractId}
            
üìã –ö–ª–∏–µ–Ω—Ç: ${contract.clientName}
üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${contract.clientPhone}
${contract.guarantorPhone ? 'üë• –ü–æ—Ä—É—á–∏—Ç–µ–ª—å: ' + contract.guarantorPhone : ''}
üìç –ê–¥—Ä–µ—Å: ${contract.address || '–ù–µ —É–∫–∞–∑–∞–Ω'}

üõçÔ∏è –¢–æ–≤–∞—Ä: ${contract.productName}
üè¢ –ü–∞—Ä—Ç–Ω–µ—Ä: ${contract.partner}
üí∞ –¶–µ–Ω–∞: ${contract.salePrice.toLocaleString()} ‚ÇΩ
üí≥ –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: ${contract.downPayment.toLocaleString()} ‚ÇΩ
üìÖ –ú–µ—Å—è—Ü–µ–≤: ${contract.months}
üíµ –ï–∂–µ–º–µ—Å—è—á–Ω–æ: ${contract.monthlyPayment.toLocaleString()} ‚ÇΩ
üí∏ –û—Å—Ç–∞—Ç–æ–∫: ${contract.remainingDebt.toLocaleString()} ‚ÇΩ

‚è∞ –ü—Ä–æ—Å—Ä–æ—á–∫–∞: ${overdueInfo.text}
üìä –°—Ç–∞—Ç—É—Å: ${contract.status === 'paid' ? '–û–ø–ª–∞—á–µ–Ω' : contract.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ü—Ä–æ—Å—Ä–æ—á–µ–Ω'}

–î–µ—Ç–∞–ª–∏ –ø–æ –≤–∑–Ω–æ—Å–∞–º –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ...`);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
        function addPaymentForContract(contractId) {
            const contract = appData.contracts.find(c => c.id === contractId);
            if (!contract) return;
            
            showPaymentModal();
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞
            setTimeout(() => {
                document.getElementById('clientSelect').value = contractId;
                document.querySelector('#paymentForm input[name="paymentAmount"]').value = contract.monthlyPayment;
            }, 100);
        }

        // –ü–æ–∏—Å–∫ –¥–æ–≥–æ–≤–æ—Ä–æ–≤
        function searchContracts(query) {
            const tbody = document.getElementById('contractsTableBody');
            const rows = tbody.getElementsByTagName('tr');
            
            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                if (text.includes(query.toLowerCase())) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞
        function showAddContractModal() {
            document.getElementById('contractModal').style.display = 'block';
            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
            const today = new Date().toISOString().split('T')[0];
            document.querySelector('#contractForm input[name="date"]');
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞
        document.getElementById('contractForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const newContract = {
                id: appData.contracts.length + 1,
                clientName: formData.get('clientName'),
                clientPhone: formData.get('clientPhone'),
                guarantorPhone: formData.get('guarantorPhone') || '',
                address: formData.get('address') || '',
                productName: formData.get('productName'),
                partner: formData.get('partner'),
                costPrice: parseInt(formData.get('costPrice')),
                salePrice: parseInt(formData.get('salePrice')),
                downPayment: parseInt(formData.get('downPayment')),
                months: parseInt(formData.get('months')),
                monthlyPayment: Math.round((parseInt(formData.get('salePrice')) - parseInt(formData.get('downPayment'))) / parseInt(formData.get('months'))),
                remainingDebt: parseInt(formData.get('salePrice')) - parseInt(formData.get('downPayment')),
                status: 'active',
                createdDate: new Date().toISOString().split('T')[0],
                imei: formData.get('imei') || '',
                discount: parseInt(formData.get('discount')) || 0
            };
            
            appData.contracts.push(newContract);
            loadContracts();
            updateDashboard();
            closeModal('contractModal');
            e.target.reset();
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤
        function loadFinance() {
            const tbody = document.getElementById('financeTableBody');
            tbody.innerHTML = '';
            
            appData.finance.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(item.date).toLocaleDateString()}</td>
                    <td>${item.type === 'income' ? '–î–æ—Ö–æ–¥' : '–†–∞—Å—Ö–æ–¥'}</td>
                    <td>${item.description}</td>
                    <td style="color: ${item.type === 'income' ? 'green' : 'red'}">
                        ${item.type === 'income' ? '+' : '-'}${item.amount.toLocaleString()} ‚ÇΩ
                    </td>
                    <td>${getSourceText(item.source)}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteFinanceItem(${item.id})">–£–¥–∞–ª–∏—Ç—å</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            updateFinanceStats();
        }

        function getSourceText(source) {
            const sources = {
                'cash': '–ù–∞–ª–∏—á–Ω—ã–µ',
                'card': '–ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ',
                'transfer': '–ü–µ—Ä–µ–≤–æ–¥',
                'other': '–î—Ä—É–≥–æ–µ'
            };
            return sources[source] || source;
        }

        function updateFinanceStats() {
            const today = new Date();
            const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            
            const dailyIncome = appData.finance
                .filter(item => item.type === 'income' && new Date(item.date).toDateString() === today.toDateString())
                .reduce((sum, item) => sum + item.amount, 0);
                
            const monthlyIncome = appData.finance
                .filter(item => item.type === 'income' && new Date(item.date) >= startOfMonth)
                .reduce((sum, item) => sum + item.amount, 0);
                
            const totalExpenses = appData.finance
                .filter(item => item.type === 'expense')
                .reduce((sum, item) => sum + item.amount, 0);
                
            const netProfit = monthlyIncome - totalExpenses;
            
            document.getElementById('dailyRevenue').textContent = dailyIncome.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('monthlyRevenue').textContent = monthlyIncome.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('totalExpenses').textContent = totalExpenses.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('netProfit').textContent = netProfit.toLocaleString() + ' ‚ÇΩ';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤
        function showFinanceModal(type) {
            document.getElementById('financeModal').style.display = 'block';
            document.getElementById('financeModalTitle').textContent = type === 'income' ? '–î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥' : '–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥';
            document.getElementById('operationType').value = type;
            
            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
            const today = new Date().toISOString().split('T')[0];
            document.querySelector('#financeForm input[name="date"]').value = today;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤
        document.getElementById('financeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const newFinanceItem = {
                id: appData.finance.length + 1,
                date: formData.get('date'),
                type: formData.get('operationType'),
                description: formData.get('description'),
                amount: parseInt(formData.get('amount')),
                source: formData.get('source')
            };
            
            appData.finance.push(newFinanceItem);
            loadFinance();
            closeModal('financeModal');
            e.target.reset();
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
        function loadPayments() {
            const tbody = document.getElementById('paymentsTableBody');
            tbody.innerHTML = '';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–µ –ø–ª–∞—Ç–µ–∂–µ–π
            const clientSelect = document.getElementById('clientSelect');
            clientSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>';
            appData.contracts.forEach(contract => {
                const option = document.createElement('option');
                option.value = contract.id;
                option.textContent = contract.clientName;
                clientSelect.appendChild(option);
            });
            
            appData.payments.forEach(payment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(payment.date).toLocaleDateString()}</td>
                    <td>${payment.clientName}</td>
                    <td>${payment.amount.toLocaleString()} ‚ÇΩ</td>
                    <td>${getPaymentTypeText(payment.type)}</td>
                    <td><span class="status-${payment.status}">${getStatusText(payment.status)}</span></td>
                    <td>
                        <button class="btn btn-danger" onclick="deletePayment(${payment.id})">–£–¥–∞–ª–∏—Ç—å</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function getPaymentTypeText(type) {
            const types = {
                'installment': '–í–∑–Ω–æ—Å –ø–æ —Ä–∞—Å—Å—Ä–æ—á–∫–µ',
                'advance': '–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞',
                'full': '–ü–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞',
                'partial': '–ß–∞—Å—Ç–∏—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞'
            };
            return types[type] || type;
        }

        function getStatusText(status) {
            const statuses = {
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω',
                'pending': '–û–∂–∏–¥–∞–µ—Ç',
                'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
            };
            return statuses[status] || status;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–ª–∞—Ç–µ–∂–µ–π
        function showPaymentModal() {
            document.getElementById('paymentModal').style.display = 'block';
            
            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
            const today = new Date().toISOString().split('T')[0];
            document.querySelector('#paymentForm input[name="paymentDate"]').value = today;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –ø–ª–∞—Ç–µ–∂–µ–π
        document.getElementById('paymentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const clientId = parseInt(formData.get('clientId'));
            const client = appData.contracts.find(c => c.id === clientId);
            
            if (!client) {
                alert('–ö–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            const newPayment = {
                id: appData.payments.length + 1,
                date: formData.get('paymentDate'),
                clientName: client.clientName,
                amount: parseInt(formData.get('paymentAmount')),
                type: formData.get('paymentType'),
                method: formData.get('paymentMethod'),
                status: 'completed'
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞ —É –∫–ª–∏–µ–Ω—Ç–∞
            if (formData.get('paymentType') === 'installment' || formData.get('paymentType') === 'partial') {
                client.remainingDebt = Math.max(0, client.remainingDebt - newPayment.amount);
                if (client.remainingDebt === 0) {
                    client.status = 'paid';
                }
            }
            
            appData.payments.push(newPayment);
            loadPayments();
            loadContracts();
            updateDashboard();
            closeModal('paymentModal');
            e.target.reset();
        });

        // –ü–æ–∏—Å–∫ –ø–ª–∞—Ç–µ–∂–µ–π
        function searchPayments(query) {
            const tbody = document.getElementById('paymentsTableBody');
            const rows = tbody.getElementsByTagName('tr');
            
            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                if (text.includes(query.toLowerCase())) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Å—ã
        function updateCashbox() {
            document.getElementById('cashAmount').textContent = appData.cashbox.cash.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('cardAmount').textContent = appData.cashbox.card.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('totalAdvance').textContent = appData.cashbox.totalAdvance.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('totalInstallments').textContent = appData.cashbox.totalInstallments.toLocaleString() + ' ‚ÇΩ';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
        function updateAnalytics(period = 'month') {
            const totalContracts = appData.contracts.length;
            const avgContractValue = totalContracts > 0 ? 
                appData.contracts.reduce((sum, c) => sum + c.salePrice, 0) / totalContracts : 0;
            const overdueContracts = appData.contracts.filter(c => c.status === 'overdue').length;
            const completedContracts = appData.contracts.filter(c => c.status === 'paid').length;
            const conversionRate = totalContracts > 0 ? (completedContracts / totalContracts * 100) : 0;
            
            document.getElementById('conversionRate').textContent = conversionRate.toFixed(1) + '%';
            document.getElementById('avgContractValue').textContent = avgContractValue.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('overdueContracts').textContent = overdueContracts;
            document.getElementById('completedContracts').textContent = completedContracts;
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞
        function exportReport() {
            const reportData = {
                contracts: appData.contracts,
                finance: appData.finance,
                payments: appData.payments,
                cashbox: appData.cashbox,
                generatedAt: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(reportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `–æ—Ç—á–µ—Ç_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
        function editContract(id) {
            const contract = appData.contracts.find(c => c.id === id);
            if (contract) {
                alert('–§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏');
            }
        }

        function deleteContract(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –¥–æ–≥–æ–≤–æ—Ä?')) {
                appData.contracts = appData.contracts.filter(c => c.id !== id);
                loadContracts();
                updateDashboard();
            }
        }

        function deleteFinanceItem(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é?')) {
                appData.finance = appData.finance.filter(f => f.id !== id);
                loadFinance();
            }
        }

        function deletePayment(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–ª–∞—Ç–µ–∂?')) {
                appData.payments = appData.payments.filter(p => p.id !== id);
                loadPayments();
                updateDashboard();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã  
        window.onload = function() {
            console.log('–°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            initializeApp();
        };
    </script>
</body>
</html>
                    id: 1,
                    clientName: "–Æ—Å—É–ø–æ–≤ –ò–±—Ä–∞–≥–∏–º",
                    clientPhone: "8988 901 44 44",
                    guarantorPhone: "",
                    address: "",
                    productName: "–ê–π—Ñ–æ–Ω 16 –ø—Ä–æ –º–∞–∫—Å 512–≥–±",
                    partner: "–•–∞–π—Ä –°—Ç—Ä–æ–π",
                    costPrice: 125000,
                    salePrice: 137500,
                    downPayment: 27500,
                    months: 4,
                    monthlyPayment: 27500,
                    remainingDebt: 0,
                    status: "paid",
                    createdDate: "2025-02-28",
                    imei: "",
                    discount: 0
                },
                {
