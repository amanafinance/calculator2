<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Amana Finance — Калькулятор рассрочки</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --accent-color: #6366f1;
      --accent-hover: #4f46e5;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --error-color: #ef4444;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --bg-primary: #ffffff;
      --bg-secondary: #f8fafc;
      --border-color: #e5e7eb;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23ffffff" fill-opacity="0.05"><circle cx="30" cy="30" r="4"/></g></g></svg>') repeat;
      pointer-events: none;
    }

    .calculator {
      width: 100%;
      max-width: 500px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 24px;
      padding: 32px;
      box-shadow: var(--shadow-xl);
      position: relative;
      overflow: hidden;
    }

    .calculator::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
      pointer-events: none;
      animation: pulse 4s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.5; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.1); }
    }

    .header {
      text-align: center;
      margin-bottom: 32px;
      position: relative;
      z-index: 1;
    }

    .header .logo {
      width: 60px;
      height: 60px;
      margin: 0 auto 16px;
      background: var(--primary-gradient);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-lg);
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .header .logo::after {
      content: '₽';
      color: white;
      font-size: 24px;
      font-weight: 700;
    }

    .header .title {
      font-size: 28px;
      font-weight: 800;
      background: var(--primary-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
      letter-spacing: -0.5px;
    }

    .header .subtitle {
      font-size: 14px;
      color: var(--text-secondary);
      font-weight: 500;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .form-section {
      position: relative;
      z-index: 1;
    }

    .tariff-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 32px;
    }

    .tariff-button {
      padding: 16px 20px;
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      cursor: pointer;
      text-align: center;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .tariff-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--primary-gradient);
      transition: left 0.3s ease;
      z-index: -1;
    }

    .tariff-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .tariff-button.active {
      background: var(--accent-color);
      color: white;
      border-color: var(--accent-color);
      box-shadow: var(--shadow-md);
    }

    .tariff-button.active::before {
      left: 0;
    }

    .input-group {
      margin-bottom: 24px;
    }

    .input-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      font-weight: 600;
      font-size: 14px;
      color: var(--text-primary);
    }

    .input-field {
      width: 100%;
      padding: 16px 20px;
      font-size: 16px;
      font-weight: 500;
      border: 2px solid var(--border-color);
      border-radius: 16px;
      background: var(--bg-primary);
      transition: all 0.3s ease;
      outline: none;
    }

    .input-field:focus {
      border-color: var(--accent-color);
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
      transform: translateY(-1px);
    }

    .slider-container {
      margin-top: 12px;
    }

    .slider {
      width: 100%;
      height: 8px;
      border-radius: 4px;
      background: var(--bg-secondary);
      outline: none;
      appearance: none;
      cursor: pointer;
      position: relative;
    }

    .slider::-webkit-slider-thumb {
      appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--accent-color);
      cursor: pointer;
      border: 4px solid white;
      box-shadow: var(--shadow-md);
      transition: transform 0.2s ease;
    }

    .slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
    }

    .slider::-moz-range-thumb {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--accent-color);
      cursor: pointer;
      border: 4px solid white;
      box-shadow: var(--shadow-md);
    }

    .months-value {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 32px;
      height: 32px;
      background: var(--accent-color);
      color: white;
      border-radius: 8px;
      font-weight: 700;
      font-size: 14px;
    }

    .prepayment-input-inline {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .prepayment-number-input {
      width: 140px !important;
      padding: 8px 12px !important;
      font-size: 14px !important;
      font-weight: 700;
      border-radius: 12px !important;
    }

    .error-message, .helper-text {
      font-size: 13px;
      padding: 12px 16px;
      margin-top: 12px;
      border-radius: 12px;
      font-weight: 500;
      display: none;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .error-message {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.2);
      color: var(--error-color);
    }

    .helper-text {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.2);
      color: #2563eb;
      display: block;
    }

    .results {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.1) 100%);
      border: 1px solid rgba(16, 185, 129, 0.2);
      border-radius: 20px;
      padding: 24px;
      margin: 32px 0;
      position: relative;
      overflow: hidden;
    }

    .results::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--success-gradient);
    }

    .result-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid rgba(16, 185, 129, 0.1);
      font-size: 15px;
    }

    .result-item:last-child {
      border-bottom: none;
      font-weight: 700;
      font-size: 16px;
    }

    .result-label {
      color: var(--text-secondary);
      font-weight: 500;
    }

    .result-value {
      font-weight: 700;
      color: var(--text-primary);
    }

    .buttons {
      display: grid;
      gap: 16px;
      margin-top: 32px;
    }

    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 16px 24px;
      border: none;
      border-radius: 16px;
      font-size: 16px;
      font-weight: 600;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.2);
      transition: left 0.3s ease;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .btn-whatsapp {
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      color: white;
    }

    .btn-phone {
      background: var(--primary-gradient);
      color: white;
    }

    .btn-icon {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }

    @media (min-width: 640px) {
      .calculator {
        padding: 40px;
        max-width: 560px;
      }
      
      .buttons {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 480px) {
      .calculator {
        margin: 10px;
        padding: 24px;
      }
      
      .header .title {
        font-size: 24px;
      }
      
      .tariff-buttons {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="calculator">
    <div class="header">
      <div class="logo"></div>
      <div class="title">AMANA FINANCE</div>
      <div class="subtitle">Калькулятор рассрочки</div>
    </div>

    <div class="form-section">
      <div class="tariff-buttons">
        <div class="tariff-button active" data-tariff="with">С первым взносом</div>
        <div class="tariff-button" data-tariff="without">Без первого взноса</div>
      </div>

      <div class="input-group">
        <label class="input-label" for="price">Стоимость товара</label>
        <input type="number" id="price" class="input-field" placeholder="не менее 50 000" min="0" />
        <div class="error-message" id="errorMessage">Стоимость товара должно быть не менее 50 000₽</div>
      </div>

      <div class="input-group">
        <label class="input-label" for="months">
          Количество месяцев
          <span class="months-value" id="monthsValue">3</span>
        </label>
        <div class="slider-container">
          <input type="range" id="months" class="slider" min="3" max="12" value="3" />
        </div>
      </div>

      <div class="input-group" id="prepaymentBlock">
        <label class="input-label">
          <div class="prepayment-input-inline">
            <span>Первый взнос</span>
            <input type="number" id="prepaymentInput" class="input-field prepayment-number-input" step="100" />
          </div>
        </label>
        <div class="error-message" id="prepaymentError"></div>
        <div class="slider-container">
          <input type="range" id="prepaymentSlider" class="slider" min="0" max="0" step="100" value="0" />
        </div>
      </div>

      <div class="results" id="results">
        <div class="result-item">
          <span class="result-label">Первый взнос:</span>
          <span class="result-value">0 ₽</span>
        </div>
        <div class="result-item">
          <span class="result-label">Ежемесячный платёж:</span>
          <span class="result-value">0 ₽</span>
        </div>
        <div class="result-item">
          <span class="result-label">Стоимость с наценкой:</span>
          <span class="result-value">0 ₽</span>
        </div>
        <div class="result-item">
          <span class="result-label">Наценка:</span>
          <span class="result-value">0 ₽ (0%)</span>
        </div>
      </div>

      <div class="helper-text">
        <strong>Обязательные требования:</strong> Поручитель и паспорта обеих лиц
      </div>

      <div class="buttons">
        <a id="whatsapp" href="#" target="_blank" class="btn btn-whatsapp">
          <svg class="btn-icon" viewBox="0 0 24 24">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.891 3.488"/>
          </svg>
          Написать на WhatsApp
        </a>
        <a class="btn btn-phone" href="tel:+79280222114">
          <svg class="btn-icon" viewBox="0 0 24 24">
            <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
          </svg>
          Позвонить
        </a>
      </div>
    </div>
  </div>

  <script>
    const priceInput = document.getElementById('price');
    const monthsInput = document.getElementById('months');
    const monthsValue = document.getElementById('monthsValue');
    const prepaymentBlock = document.getElementById('prepaymentBlock');
    const prepaymentSlider = document.getElementById('prepaymentSlider');
    const prepaymentInput = document.getElementById('prepaymentInput');
    const prepaymentError = document.getElementById('prepaymentError');
    const resultsDiv = document.getElementById('results');
    const whatsappBtn = document.getElementById('whatsapp');
    const errorMessage = document.getElementById('errorMessage');
    const tariffButtons = document.querySelectorAll('.tariff-button');

    let selectedTariff = 'with';
    let conditionalPrepayment = 0;

    const markupWithDown = {3:9,4:12,5:15,6:18,7:20,8:22,9:24,10:26,11:28,12:30};
    const markupWithoutDown = {3:14,4:18,5:23,6:28,7:31,8:33,9:37,10:40,11:43,12:46};

    const roundUpTo100 = val => Math.ceil(val / 100) * 100;

    function togglePrepaymentSlider() {
      prepaymentBlock.style.display = selectedTariff === 'with' ? 'block' : 'none';
    }

    function updateCalculator(resetPrepayment = false) {
      const months = parseInt(monthsInput.value);
      monthsValue.textContent = months;

      const price = parseInt(priceInput.value);
      if (isNaN(price) || price < 50000) {
        errorMessage.style.display = 'block';
        errorMessage.textContent = 'Стоимость товара должно быть не менее 50 000₽';
        prepaymentInput.value = 0;
        prepaymentError.style.display = 'none';
        resultsDiv.innerHTML = `
          <div class="result-item"><span class="result-label">Первый взнос:</span><span class="result-value">0 ₽</span></div>
          <div class="result-item"><span class="result-label">Ежемесячный платёж:</span><span class="result-value">0 ₽</span></div>
          <div class="result-item"><span class="result-label">Стоимость с наценкой:</span><span class="result-value">0 ₽</span></div>
          <div class="result-item"><span class="result-label">Наценка:</span><span class="result-value">0 ₽ (0%)</span></div>
        `;
        whatsappBtn.href = "https://wa.me/79280222114?text=Здравствуйте, хочу оформить рассрочку.";
        togglePrepaymentSlider();
        return;
      } else {
        errorMessage.style.display = 'none';
      }

      const percent = selectedTariff === 'with' ? markupWithDown[months] : markupWithoutDown[months];
      const baseFinalCost = price * (1 + percent / 100);

      let prepayment = 0, monthly = 0, finalCost = 0, message = "";

      if (selectedTariff === 'with') {
        const minPrepayment = roundUpTo100(baseFinalCost * 0.15);
        const maxPrepayment = roundUpTo100(baseFinalCost * 0.65);
        conditionalPrepayment = roundUpTo100(baseFinalCost * 0.25);

        prepaymentSlider.min = minPrepayment;
        prepaymentSlider.max = maxPrepayment;

        if (resetPrepayment) {
          prepaymentSlider.value = conditionalPrepayment;
        }

        if (Math.abs(prepaymentSlider.value - conditionalPrepayment) <= 2000) {
          prepaymentSlider.value = conditionalPrepayment;
        }

        prepayment = parseInt(prepaymentSlider.value);
        prepaymentInput.value = prepayment;

        if (prepayment === conditionalPrepayment) {
          const remaining = baseFinalCost - prepayment;
          monthly = roundUpTo100(remaining / months);
          finalCost = monthly * months + prepayment;
        } else {
          const remaining = price - prepayment;
          const remainingWithMarkup = remaining * (1 + markupWithoutDown[months] / 100);
          monthly = roundUpTo100(remainingWithMarkup / months);
          finalCost = monthly * months + prepayment;
        }

        message = `Здравствуйте, хочу оформить рассрочку. Стоимость товара: ${price.toLocaleString()} ₽, Тариф: С первым взносом, Первый взнос: ${prepayment.toLocaleString()} ₽, Срок: ${months} мес.`;

      } else {
        monthly = roundUpTo100(baseFinalCost / months);
        finalCost = monthly * months;
        prepaymentInput.value = "0";
        prepayment = 0;
        message = `Здравствуйте, хочу оформить рассрочку. Стоимость товара: ${price.toLocaleString()} ₽, Тариф: Без первого взноса, Срок: ${months} мес.`;
      }

      const markup = finalCost - price;
      const markupPercent = Math.round((markup / price) * 100);

      resultsDiv.innerHTML = `
        <div class="result-item"><span class="result-label">Первый взнос:</span><span class="result-value">${prepayment.toLocaleString()} ₽</span></div>
        <div class="result-item"><span class="result-label">Ежемесячный платёж:</span><span class="result-value">${monthly.toLocaleString()} ₽</span></div>
        <div class="result-item"><span class="result-label">Стоимость с наценкой:</span><span class="result-value">${finalCost.toLocaleString()} ₽</span></div>
        <div class="result-item"><span class="result-label">Наценка:</span><span class="result-value">${markup.toLocaleString()} ₽ (${markupPercent}%)</span></div>
      `;

      whatsappBtn.href = `https://wa.me/79280222114?text=${encodeURIComponent(message)}`;
      prepaymentError.style.display = 'none';
      togglePrepaymentSlider();
    }

    tariffButtons.forEach(button => {
      button.addEventListener('click', () => {
        tariffButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        selectedTariff = button.dataset.tariff;
        updateCalculator(true);
      });
    });

    priceInput.addEventListener('input', () => updateCalculator(true));
    monthsInput.addEventListener('input', () => updateCalculator(true));
    prepaymentSlider.addEventListener('input', () => updateCalculator(false));

    prepaymentInput.addEventListener('input', () => {
      const val = roundUpTo100(parseInt(prepaymentInput.value || '0'));
      const min = parseInt(prepaymentSlider.min);
      const max = parseInt(prepaymentSlider.max);

      if (val >= min && val <= max) {
        prepaymentError.style.display = 'none';
        prepaymentSlider.value = val;
        updateCalculator(false);
      } else {
        prepaymentError.textContent = `Первый взнос должен быть от ${min.toLocaleString()}₽ до ${max.toLocaleString()}₽`;
        prepaymentError.style.display = 'block';
      }
    });

    updateCalculator(true);
  </script>
</body>
</html>
